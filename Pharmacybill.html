# pharmcy master with upload.

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pharmacy Master System</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #e6f2ff;
      margin: 0;
    }

    .login-page, .form-page {
      display: none;
      padding: 40px;
      text-align: center;
    }

    .login-page.active, .form-page.active {
      display: block;
    }

    .form-container {
      max-width: 1100px;
      margin: auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    h2 {
      color: #007bff;
      margin-bottom: 20px;
    }

    input[type="text"], input[type="number"], input[type="date"], input[type="password"] {
      width: 100%;
      padding: 6px;
      border: 1px solid #aaa;
      border-radius: 4px;
    }

    table {
      width: 100%;
      margin-top: 10px;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
    }

    th {
      background-color: #b3daff;
    }

    button {
      background-color: #007bff;
      color: white;
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    .button-group {
      text-align: center;
      margin-top: 20px;
    }

    .login-box {
      max-width: 400px;
      margin: auto;
      padding: 30px;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .add-row {
      background-color: #28a745;
    }

    .add-row:hover {
      background-color: #1c7c31;
    }
  </style>
</head>
<body>

<!-- LOGIN PAGE -->
<div class="login-page active" id="loginPage">
  <div class="login-box">
    <h2>Login</h2>
    <input type="text" id="userId" placeholder="User ID"><br><br>
    <input type="password" id="password" placeholder="Password"><br><br>
    <button onclick="login()">Login</button>
  </div>
</div>

<!-- FORM PAGE -->
<div class="form-page" id="formPage">
  <div class="form-container">
    <h2>Pharmacy Master Form</h2>

    <table id="masterTable">
      <thead>
        <tr>
          <th>Item Name</th>
          <th>Batch No</th>
          <th>Expiry Date</th>
          <th>Pack</th>
          <th>Available Qty</th>
          <th>Buying Price</th>
          <th>MRP</th>
          <th>Selling Price</th>
          <th>Med Code</th>
        </tr>
      </thead>
      <tbody id="formRows">
        <!-- Rows will be added dynamically -->
      </tbody>
    </table>

    <div class="button-group">
      <button class="add-row" onclick="addRow()">+ Add Row</button>
      <button onclick="saveForm()">Save</button>
      <button onclick="clearForm()">Clear</button>
      <input type="file" id="uploadExcel" accept=".xlsx, .xls" style="display: none;" onchange="handleExcelUpload(event)">
      <button onclick="document.getElementById('uploadExcel').click()">Upload from Excel</button>
    </div>
  </div>
</div>

<script>
  // LOGIN LOGIC
  function login() {
    const userId = document.getElementById('userId').value;
    const password = document.getElementById('password').value;

    if (userId === "admin" && password === "1234") {
      document.getElementById('loginPage').classList.remove('active');
      document.getElementById('formPage').classList.add('active');
      addRow(); // Add initial row
    } else {
      alert("Invalid login. Try again.");
    }
  }

  // ADD ROW TO TABLE
  function addRow(data = {}) {
    const tbody = document.getElementById("formRows");
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><input type="text" name="itemName" value="${data["Item Name"] || ""}"></td>
      <td><input type="text" name="batch" value="${data["Batch No"] || ""}"></td>
      <td><input type="date" name="expiry" value="${data["Expiry Date"] ? formatDate(data["Expiry Date"]) : ""}"></td>
      <td><input type="text" name="pack" value="${data["Pack"] || ""}"></td>
      <td><input type="number" name="qty" value="${data["Available Qty"] || ""}"></td>
      <td><input type="number" name="buyingPrice" value="${data["Buying Price"] || ""}"></td>
      <td><input type="number" name="mrp" value="${data["MRP"] || ""}"></td>
      <td><input type="number" name="sellingPrice" value="${data["Selling Price"] || ""}"></td>
      <td><input type="text" name="medCode" value="${data["Med Code"] || ""}"></td>
    `;
    tbody.appendChild(tr);
  }

  // SAVE FORM
  function saveForm() {
    const rows = document.querySelectorAll("#formRows tr");
    const data = [];
    rows.forEach(row => {
      const inputs = row.querySelectorAll("input");
      const rowData = {};
      inputs.forEach(input => rowData[input.name] = input.value);
      data.push(rowData);
    });
    console.log("Saved Data:", data);
    alert("Data saved (check console)");
  }

  // CLEAR FORM
  function clearForm() {
    document.getElementById("formRows").innerHTML = "";
  }

  // EXCEL UPLOAD
  function handleExcelUpload(event) {
    const file = event.target.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: "array" });
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const jsonData = XLSX.utils.sheet_to_json(sheet);
      populateTableFromExcel(jsonData);
    };
    reader.readAsArrayBuffer(file);
  }

  function populateTableFromExcel(data) {
    clearForm();
    data.forEach(row => addRow(row));
  }

  function formatDate(dateString) {
    const date = new Date(dateString);
    const yyyy = date.getFullYear();
    const mm = String(date.getMonth() + 1).padStart(2, '0');
    const dd = String(date.getDate()).padStart(2, '0');
    return `${yyyy}-${mm}-${dd}`;
  }
</script>

</body>
</html>
